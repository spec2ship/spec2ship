# CTX-001: Context Reduction Strategies

**Status**: draft
**Priority**: medium
**Category**: Context
**Created**: 2026-01-11
**Updated**: 2026-01-11

## Context

Context window limits are a fundamental constraint. This is critical for:
- Long roundtable sessions
- Large projects with extensive documentation
- Multiple rounds with many artifacts

## User Clarification

**--simulate mode definition**: The command simulates the roundtable WITHOUT spawning agents. Instead of invoking Task() for each participant, the command:
1. Reads participant agent .md files
2. Impersonates each role inline based on their description
3. Generates responses as if each participant spoke

This drastically reduces token usage because:
- No separate agent context windows
- No parallel Task() invocations
- Single conversation thread handles all roles

**Scope options** (to be refined):
- `--simulate` (default): Simulate all rounds
- `--simulate=round`: Simulate only current round
- `--simulate=phase`: Simulate all rounds in current phase
- `--simulate=N`: Simulate N rounds

## Proposal

### 1. --simulate Mode (PRIMARY)

- Command reads participant .md files (expertise, critical stance, workflow focus)
- Command impersonates each participant role inline
- NO Task() invocations for participants
- Facilitator logic also simulated inline
- Output marked as "SIMULATED" in session file
- Useful for: testing, exploration, token-constrained environments

**Implementation approach**:
```markdown
For each participant in round:
  1. Read agents/roundtable/{participant}.md
  2. Extract: expertise, critical_stance, workflow_focus
  3. Generate response as: "As {participant}, considering {expertise}..."
  4. Add to round responses
```

### 2. Progressive Context Loading

- Start with minimal context
- Load additional context only when referenced
- Facilitator requests specific context as needed

### 3. Context Summarization

- After each round, summarize rather than keep full transcript
- Keep artifact IDs, discard discussion details
- Configurable verbosity level

### 4. Batch Questions

- Instead of one question per round, batch related questions
- Reduces round overhead
- Participants answer multiple questions in single response

### 5. Skill Segregation

- Load only workflow-specific skills
- Don't load arc42 skills in specs workflow
- Don't load iso25010 in design workflow

### Files to Modify
- `commands/specs.md`, `design.md`, `brainstorm.md` (add --simulate)
- Session file schema (add simulated flag)

## Acceptance Criteria

- [ ] `--simulate` flag implemented in specs, design, brainstorm
- [ ] Simulated sessions clearly marked
- [ ] Token reduction measured (target: 70%+ for simulate mode)
- [ ] Quality comparison: simulated vs real (acceptable for exploration)
- [ ] Scope options work (round, phase, N)

## Related

- Related to: RT-004 (Splitting) - complementary strategies
- Related to: RT-001 (Phases) - phase boundaries help context
- Related to: TEST-001 (Testing) - simulate useful for testing
- Supersedes: Old P4-1 (Skill segregation)

## Open Questions

- What's the quality trade-off? (Needs experimentation)
- Should simulated mode use different output format?
- How to handle artifacts in simulated mode? (Still create, or also simulate?)
- Default scope: all rounds or single round?

## Notes

--simulate is particularly valuable for:
1. Testing roundtable flow without token cost
2. Quick exploration before committing to full session
3. Development/debugging of s2s itself
